{"version":3,"sources":["music.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"music.js","sourcesContent":["$(document).ready(function() {\r\n    /**\r\n     * 点击新建按钮\r\n     */\r\n    $(\"#createMusic\").click(function() {\r\n        ajaxSubmitForm();\r\n        function ajaxSubmitForm() {\r\n           var value = $(\"#midi-file\").val();\r\n           if (isEmpty(value)) {\r\n               alert(\"请先选择文件\");\r\n               return false;\r\n           }\r\n           function isEmpty( inputStr ) {\r\n               if ( null == inputStr || \"\" == inputStr ) {\r\n                   return true;\r\n               }\r\n               return false;\r\n            }\r\n           if (!value.match(/.mid/i)) {\r\n               alert(\"文件格式错误\");\r\n               return false;\r\n           }\r\n           var option = {\r\n               url : 'music',\r\n               type : 'POST',\r\n               dataType : 'json',\r\n               data: {\r\n                   'name': $(\"#title\").val(),\r\n                   'author': $(\"#author\").val()\r\n               },\r\n               headers : {\r\n                //    \"ClientCallMode\" : \"ajax\"\r\n                   'X-CSRF-TOKEN': $('input[name=\"_token\"]').val()\r\n               }, //添加请求头部\r\n               success : function(data) {\r\n                   $(\"#addResult\").html(\"添加成功\");\r\n                   $(\"#addResult\").hide('slow', function() {\r\n\r\n                   });\r\n\r\n               },\r\n               error : function(data) {\r\n                   alert(JSON.stringify(data) + \"--上传失败,请刷新后重试\");\r\n               }\r\n           };\r\n           $(\"#add_music\").ajaxSubmit(option);\r\n           return false; //最好返回false，因为如果按钮类型是submit,则表单自己又会提交一次;返回false阻止表单再次提交\r\n        }\r\n    });\r\n\r\n    // 点击\"编辑\"按钮\r\n    $(\".edit\").each(function(index, el) {\r\n        $(this).click(function() {\r\n            $(\"#edit_id\").val($(el).closest('tr').attr('id'));\r\n            $(\"#edit_title\").val($(el).closest('tr').find('td:eq(0)').text());\r\n            $(\"#edit_author\").val($(el).closest('tr').find('td:eq(1)').text());\r\n        });\r\n    });\r\n\r\n    // 点击\"保存修改\"按钮\r\n    $(\"#save\").bind('click', function(event) {\r\n        ajaxSubmitForm();\r\n        function ajaxSubmitForm() {\r\n            var $id_value = $(\"#edit_id\").val();\r\n            var option = {\r\n                url : 'music/' + $id_value,\r\n                type : 'put',\r\n                dataType : 'json',\r\n                data : {\r\n                    'name' : $(\"#edit_title\").val(),\r\n                    'author' : $(\"#edit_author\").val()\r\n                },\r\n                headers : {\r\n                    'X-CSRF-TOKEN': $('input[name=\"_token\"]').val()\r\n                },\r\n                success : function(data) {\r\n                    $(\"#addResult\").html(\"修改成功!\");\r\n                },\r\n                error : function(data) {\r\n                    alert('哦，出了点小问题，再试一次吧');\r\n                }\r\n                // error : function(data) {\r\n                //     alert(JSON.stringify(data) + \"--添加失败, 请重试\");\r\n                // }\r\n            }\r\n            $(\"#save_detail\").ajaxSubmit(option);\r\n            return false;\r\n        }\r\n    });\r\n\r\n    // 点击\"删除\"按钮\r\n    $(\".delete\").each(function(indel, el) {\r\n        $(this).bind('click', function(event) {\r\n            $.ajax({\r\n                url: '/music/' + $(el).closest('tr').attr('id'),\r\n                type: 'DELETE',\r\n                dataType: 'json',\r\n                headers : {\r\n                    'X-CSRF-TOKEN': $('input[name=\"_token\"]').val()\r\n                }\r\n            })\r\n            .done(function() {\r\n                console.log(\"success\");\r\n                $(el).closest('tr').remove();\r\n\r\n            })\r\n            .fail(function() {\r\n                console.log(\"error\");\r\n            })\r\n            .always(function() {\r\n                console.log(\"complete\");\r\n            });\r\n        });\r\n    });\r\n\r\n    /**\r\n     * 自动拉取筛选待件\r\n     */\r\n    $.ajax({\r\n        url: '/music/condations',\r\n        type: 'GET',\r\n        dataType: 'json',\r\n        headers : {\r\n            'X-CSRF-TOKEN': $('input[name=\"_token\"]').val()\r\n        }\r\n    })\r\n    .done(function(data) {\r\n        console.log(\"success\");\r\n        $.each(data, function(n, value) {\r\n            var $str = \"\";\r\n            $str = \"<option value=\" + value.id + \">\" + value.name + \"</option>\";\r\n            $(\"#instruments\").append($str);\r\n        });\r\n    })\r\n    .fail(function(data) {\r\n        console.log(data);\r\n    })\r\n    .always(function() {\r\n        console.log(\"complete\");\r\n    });\r\n\r\n\r\n\r\n});\r\n"],"sourceRoot":"/source/"}